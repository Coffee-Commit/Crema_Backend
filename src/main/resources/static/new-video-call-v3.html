<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CremaChat - í™”ìƒí†µí™” v3</title>
    <link rel="stylesheet" href="new-video-call-v3.css">
    <!-- Font Awesome ì•„ì´ì½˜ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- OpenVidu ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://github.com/OpenVidu/openvidu/releases/download/v2.30.0/openvidu-browser-2.30.0.js"></script>
    <script type="text/javascript">
        // OpenVidu ì„œë²„ URL ì „ì—­ ì„¤ì •
        window.OPENVIDU_SERVER_URL = 'https://crema.bitcointothemars.com/openvidu';
        window.OPENVIDU_SERVER_SECRET = 'MY_SECRET';
        
        // í˜ì´ì§€ ë¡œë“œ í›„ OpenVidu ì´ˆê¸°í™” í™•ì¸
        document.addEventListener('DOMContentLoaded', function() {
            console.log('OpenVidu available:', typeof OpenVidu !== 'undefined');
            console.log('WebRTC available:', typeof RTCPeerConnection !== 'undefined');
        });
    </script>
</head>
<body>
    <div class="chat-container">
        <!-- í—¤ë” -->
        <header class="chat-header">
            <div class="logo-timer">
                <span class="logo">CremaChat</span>
                <span class="timer" id="callDuration">11:01</span>
            </div>
            <div class="header-tabs">
                <button class="tab-button active" id="chatTabBtn">ì±„íŒ… <span class="badge" id="chatBadge">0</span></button>
                <button class="tab-button" id="filesTabBtn">ê³µìœ ëœ ìë£Œ</button>
            </div>
        </header>

        <!-- ë©”ì¸ ì»¨í…ì¸  -->
        <main class="main-content">
            <!-- ë¹„ë””ì˜¤ ì˜ì—­ -->
            <div class="video-area">
                <!-- ì²« ë²ˆì§¸ ë¹„ë””ì˜¤ í™”ë©´ -->
                <div class="video-screen" id="leftVideoScreen">
                    <video id="leftVideo" autoplay playsinline></video>
                    <div class="video-overlay" id="leftVideoOverlay">
                        <div class="no-video-message">
                            <div class="no-video-avatar">ğŸ“¹</div>
                            <p>ë¹„ë””ì˜¤ê°€ êº¼ì ¸ìˆìŠµë‹ˆë‹¤</p>
                        </div>
                    </div>
                    <span class="user-tag" id="leftUserTag">ì°¸ê°€ì</span>
                </div>
                
                <!-- ë‘ ë²ˆì§¸ ë¹„ë””ì˜¤ í™”ë©´ -->
                <div class="video-screen" id="rightVideoScreen">
                    <video id="rightVideo" autoplay playsinline></video>
                    <div class="video-overlay" id="rightVideoOverlay">
                        <div class="no-video-message">
                            <div class="no-video-avatar">ğŸ“¹</div>
                            <p>ë¹„ë””ì˜¤ê°€ êº¼ì ¸ìˆìŠµë‹ˆë‹¤</p>
                        </div>
                    </div>
                    <span class="user-tag" id="rightUserTag">ë‚˜</span>
                </div>
            </div>

            <!-- ì‚¬ì´ë“œë°” -->
            <aside class="sidebar">
                <!-- ì±„íŒ… ì„¹ì…˜ -->
                <div class="sidebar-section" id="chatSection">
                    <div class="chat-messages" id="chatMessages">
                        <!-- ì±„íŒ… ë©”ì‹œì§€ë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                    <div class="chat-input-container">
                        <input type="text" id="chatInput" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." maxlength="200">
                        <input type="file" id="fileInput" style="display: none;" accept="image/*,.pdf,.doc,.docx,.txt">
                        <button id="fileUploadBtn" title="íŒŒì¼ ì²¨ë¶€">ğŸ“</button>
                        <button id="sendMessageBtn">ì „ì†¡</button>
                    </div>
                </div>
                
                <!-- ê³µìœ  ìë£Œ ì„¹ì…˜ -->
                <div class="sidebar-section" id="filesSection" style="display: none;">
                    <div class="files-content">
                        <p class="section-title">êµ¬ì²´ì  ì •ë³´ (ì‚¬ì§„ ê³µìœ  ìë£Œ í¬í•¨)</p>
                        <div class="info-placeholder" id="infoPlaceholder"></div>
                        
                        <p class="section-title">ì‚¬ì§„ ì—…ë¡œë“œ | ê³µìœ  ìë£Œ</p>
                        <div class="shared-files" id="sharedFiles">
                            <div class="file-placeholder"></div>
                            <div class="file-placeholder"></div>
                            <div class="file-placeholder"></div>
                        </div>
                    </div>
                </div>
            </aside>
        </main>

        <!-- ì»¨íŠ¸ë¡¤ ë°” -->
        <footer class="control-bar">
            <div class="controls-left">
                <button class="control-button" id="settingsBtn" title="ì„¤ì •">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
            <div class="controls-center">
                <button class="control-button" id="toggleAudioBtn" title="ë§ˆì´í¬ on/off">
                    <i class="fas fa-microphone"></i>
                </button>
                <button class="control-button" id="toggleVideoBtn" title="ë¹„ë””ì˜¤ on/off">
                    <i class="fas fa-video"></i>
                </button>
                <button class="control-button" id="toggleScreenShareBtn" title="í™”ë©´ê³µìœ ">
                    <i class="fas fa-desktop"></i>
                </button>
                <button class="control-button end-call" id="leaveSessionBtn" title="í†µí™” ì¢…ë£Œ">
                    <i class="fas fa-phone"></i>
                </button>
            </div>
            <div class="controls-right">
                <!-- ì°¸ê°€ì ì •ë³´ -->
                <div class="participant-info">
                    <div class="user-avatar" id="currentUserAvatar">ğŸ‘¤</div>
                    <span class="user-name" id="currentUserName">ì‚¬ìš©ì</span>
                </div>
            </div>
        </footer>
    </div>

    <!-- ë¡œë”© í™”ë©´ -->
    <div id="loadingScreen" class="loading-screen" style="display: none;">
        <div class="loading-spinner"></div>
        <p>ì—°ê²° ì¤‘...</p>
    </div>

    <!-- ì•Œë¦¼ í† ìŠ¤íŠ¸ -->
    <div id="toast" class="toast" style="display: none;">
        <span id="toastMessage"></span>
    </div>

    <!-- ì°¸ê°€ì ëª©ë¡ ìˆ¨ê²¨ì§„ ì»¨í…Œì´ë„ˆ (ë°ì´í„° ì €ì¥ìš©) -->
    <div style="display: none;">
        <div id="participantsList"></div>
        <span id="participantCount">0</span>
    </div>

    <script src="new-video-call-v3.js"></script>
</body>
</html>